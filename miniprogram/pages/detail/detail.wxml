<!--detail.wxml-->
<view class="container">

  <!-- äº§å“è¯¦æƒ… Header -->
  <view wx:if="{{type === 'product' && product}}" class="page-header product-header">
    <view class="header-body">
      <text class="header-icon">â˜•</text>
      <text class="header-title">{{product.name}}</text>
    </view>
    <view class="header-badge product-badge">äº§å“</view>
  </view>

  <!-- ç‰©æ–™è¯¦æƒ… Header -->
  <view wx:if="{{type === 'material' && material}}" class="page-header material-header">
    <view class="header-body">
      <text class="header-icon">{{material.category === 'packaging' ? 'ğŸ“¦' : 'ğŸ«™'}}</text>
      <text class="header-title">{{material.name}}</text>
    </view>
    <view class="header-badge material-badge">{{material.category === 'material' ? 'åŸæ–™' : 'åŒ…è£…'}}</view>
  </view>

  <!-- â”€â”€â”€â”€â”€â”€â”€â”€â”€ äº§å“è¯¦æƒ…å†…å®¹ â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
  <view wx:if="{{type === 'product' && product}}" class="content">

    <!-- æ€»æˆæœ¬å¤§å¡ç‰‡ -->
    <view class="hero-card">
      <text class="hero-label">TOTAL COST</text>
      <view class="hero-amount">
        <text class="hero-currency">Â¥</text>
        <text class="hero-number">{{costInfo ? costInfo.totalCost : 0}}</text>
      </view>
      <text class="hero-sub">åŸºäºå½“å‰ç‰©æ–™ä»·æ ¼å®æ—¶è®¡ç®—</text>
    </view>

    <!-- æˆæœ¬æ˜ç»† -->
    <view class="section">
      <view class="section-hd">
        <text class="section-title">æˆæœ¬æ˜ç»†</text>
        <!-- â‘¡ ç”¨ view åŒ…è£¹ï¼Œæ‰èƒ½ flex å±…ä¸­ -->
        <view class="section-badge" wx:if="{{costInfo && costInfo.details}}">
          <text class="section-badge-text">{{costInfo.details.length}} é¡¹</text>
        </view>
      </view>

      <view wx:if="{{costInfo && costInfo.details && costInfo.details.length > 0}}">
        <view
          wx:for="{{costInfo.details}}"
          wx:key="index"
          class="ingredient-row"
        >
          <view class="ingredient-body">
            <!-- â‘¢ å½©ç‚¹å’Œåç§°ã€æ ‡ç­¾åœ¨åŒä¸€ä¸ª flex å®¹å™¨å†… -->
            <view class="ingredient-top">
              <view class="ingredient-dot {{item.category === 'material' ? 'dot-blue' : 'dot-green'}}"></view>
              <text class="ingredient-name">{{item.materialName}}</text>
              <text class="ingredient-tag {{item.category === 'material' ? 'tag-blue' : 'tag-green'}}">{{item.category === 'material' ? 'åŸæ–™' : 'åŒ…è£…'}}</text>
            </view>
            <text class="ingredient-formula">{{item.amount}} {{item.unit}} Ã— Â¥{{item.unitPrice}} / {{item.unit}}</text>
          </view>
          <text class="ingredient-cost">Â¥{{item.itemCost}}</text>
        </view>
      </view>

      <view wx:else class="empty-detail">
        <text>æš‚æ— æˆæœ¬æ˜ç»†</text>
      </view>
    </view>

  </view>

  <!-- â”€â”€â”€â”€â”€â”€â”€â”€â”€ ç‰©æ–™è¯¦æƒ…å†…å®¹ â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
  <view wx:if="{{type === 'material' && material}}" class="content">

    <!-- å•ä½æˆæœ¬å¤§å¡ç‰‡ -->
    <view class="hero-card">
      <text class="hero-label">UNIT COST</text>
      <view class="hero-amount">
        <text class="hero-currency">Â¥</text>
        <text class="hero-number">{{unitPrice}}</text>
        <text class="hero-unit">/ {{material.spec_unit}}</text>
      </view>
      <text class="hero-sub">åŸºäºè§„æ ¼ä¿¡æ¯è®¡ç®—</text>
    </view>

    <!-- è§„æ ¼ä¿¡æ¯ -->
    <view class="section">
      <view class="section-hd">
        <text class="section-title">è§„æ ¼ä¿¡æ¯</text>
      </view>
      <view class="spec-grid">
        <view class="spec-cell">
          <text class="spec-label">è§„æ ¼æ•°é‡</text>
          <text class="spec-value">{{material.spec_amount}}</text>
          <text class="spec-unit-text">{{material.spec_unit}}</text>
        </view>
        <view class="spec-divider"></view>
        <view class="spec-cell">
          <text class="spec-label">è§„æ ¼æ€»ä»·</text>
          <text class="spec-value price-amber">{{material.spec_price}}</text>
          <text class="spec-unit-text">å…ƒ</text>
        </view>
      </view>
    </view>

    <!-- åˆ†ç±»æ ‡ç­¾ -->
    <view class="section category-section">
      <text class="category-label">åˆ†ç±»</text>
      <view class="category-tag {{material.category === 'material' ? 'tag-blue-lg' : 'tag-green-lg'}}">
        <text class="category-icon">{{material.category === 'packaging' ? 'ğŸ“¦' : 'ğŸ«™'}}</text>
        <text class="category-text">{{material.category === 'material' ? 'åŸæ–™' : 'åŒ…è£…'}}</text>
      </view>
    </view>

  </view>

</view>
