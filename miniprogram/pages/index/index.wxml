<!--index.wxml-->
<view class="container">

  <!-- é¡¶éƒ¨å“ç‰ŒåŒº + æœç´¢æ¡† -->
  <view class="header">
    <view class="brand">
      <text class="brand-logo">â˜•</text>
      <view class="brand-info">
        <text class="brand-name">Lucky Cup</text>
        <text class="brand-tagline">Cost Calculator</text>
      </view>
    </view>
    <view class="search-bar">
      <text class="search-icon">âŒ•</text>
      <input
        class="search-input"
        placeholder="æœç´¢äº§å“æˆ–ç‰©æ–™åç§°..."
        placeholder-class="search-placeholder"
        value="{{searchKeyword}}"
        bindinput="onSearchInput"
        confirm-type="search"
      />
    </view>
  </view>

  <!-- åˆå§‹ç©ºç™½æç¤º -->
  <view wx:if="{{!searchKeyword}}" class="empty-state">
    <text class="empty-icon">â˜•</text>
    <text class="empty-title">æœç´¢å¼€å§‹</text>
    <text class="empty-desc">è¾“å…¥å…³é”®è¯æœç´¢äº§å“æˆ–ç‰©æ–™</text>
  </view>

  <!-- æœç´¢ç»“æœ -->
  <view wx:if="{{searchKeyword}}" class="results">

    <!-- äº§å“ç»“æœ -->
    <view wx:if="{{productResults.length > 0}}" class="result-section">
      <view class="section-header">
        <view class="section-label-wrap">
          <view class="section-dot product-dot"></view>
          <text class="section-label">äº§å“</text>
        </view>
        <text class="section-count">{{productResults.length}} é¡¹</text>
      </view>
      <view
        wx:for="{{productResults}}"
        wx:key="_id"
        class="result-card"
        bindtap="goToProductDetail"
        data-item="{{item}}"
      >
        <view class="card-accent product-accent"></view>
        <view class="card-main">
          <view class="card-icon-wrap product-icon-bg">
            <text class="card-icon">â˜•</text>
          </view>
          <view class="card-info">
            <text class="card-name">{{item.name}}</text>
            <view class="card-cost-row">
              <text class="cost-label">æˆæœ¬</text>
              <text class="cost-value">Â¥ {{item.totalCost}}</text>
            </view>
          </view>
        </view>
        <text class="card-arrow">â€º</text>
      </view>
    </view>

    <!-- ç‰©æ–™ç»“æœ -->
    <view wx:if="{{materialResults.length > 0}}" class="result-section">
      <view class="section-header">
        <view class="section-label-wrap">
          <view class="section-dot material-dot"></view>
          <text class="section-label">ç‰©æ–™</text>
        </view>
        <text class="section-count">{{materialResults.length}} é¡¹</text>
      </view>
      <view
        wx:for="{{materialResults}}"
        wx:key="_id"
        class="result-card"
        bindtap="goToMaterialDetail"
        data-item="{{item}}"
      >
        <view class="card-accent material-accent"></view>
        <view class="card-main">
          <view class="card-icon-wrap material-icon-bg">
            <text class="card-icon">{{item.category === 'packaging' ? 'ğŸ“¦' : 'ğŸ«™'}}</text>
          </view>
          <view class="card-info">
            <text class="card-name">{{item.name}}</text>
            <view class="card-meta-row">
              <text class="meta-spec">{{item.spec_amount}}{{item.spec_unit}} / Â¥{{item.spec_price}}</text>
              <text class="meta-unit-cost">Â¥{{item.unitPrice}}/{{item.spec_unit}}</text>
            </view>
          </view>
        </view>
        <text class="card-arrow">â€º</text>
      </view>
    </view>

    <!-- æ— ç»“æœ -->
    <view wx:if="{{hasNoResult && !isSearching}}" class="no-result">
      <text class="no-result-icon">â—</text>
      <text class="no-result-title">æœªæ‰¾åˆ°ç›¸å…³ç»“æœ</text>
      <text class="no-result-desc">è¯·å°è¯•å…¶ä»–å…³é”®è¯</text>
    </view>

  </view>

</view>
